<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PetMarket Online</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.9.1/font/bootstrap-icons.css">
  <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
  <link rel="stylesheet" href="./css/main.css">
  <style>
    /* 🔹 Estilo del botón flotante de soporte */
    .btn-soporte {
      position: fixed;
      bottom: 25px;
      right: 25px;
      background-color: #25d366;
      color: white;
      border-radius: 50%;
      width: 60px;
      height: 60px;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 30px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
      z-index: 1000;
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }
    .btn-soporte:hover {
      transform: scale(1.1);
      box-shadow: 0 6px 10px rgba(0, 0, 0, 0.3);
    }
  </style>
</head>
<body>

  <div class="wrapper">
    <aside>
      <header>
        <h1 class="logo">PetMarket Online</h1>
      </header>

      <nav>
        <ul class="menu">
          <li>
            <button id="todos" class="boton-menu boton-categoria active">
              <i class="bi bi-hand-index-thumb-fill"></i> Todos los productos
            </button>
          </li>
          <li>
            <button id="Accesorios" class="boton-menu boton-categoria">
              <i class="bi bi-hand-index-thumb"></i> Accesorios
            </button>
          </li>
          <li>
            <button id="Juguetes" class="boton-menu boton-categoria">
              <i class="bi bi-hand-index-thumb"></i> Juguetes
            </button>
          </li>
          <li>
            <button id="Higiene" class="boton-menu boton-categoria">
              <i class="bi bi-hand-index-thumb"></i> Higiene
            </button>
          </li>
          <li>
            <a class="boton-menu boton-carrito" href="./carrito.html">
              <i class="bi bi-cart-fill"></i> Carrito <span id="numerito" class="numerito">0</span>
            </a>
          </li>
        </ul>
      </nav>

      <!-- 🔍 Buscador funcional -->
      <div class="buscador" style="margin-bottom: 20px;">
        <input type="text" id="input-busqueda" placeholder="Buscar productos...">
        <i class="bi bi-search" id="boton-buscar"></i>
      </div>

      <!-- 🔹 Login con Google -->
      <div id="user-area">
        <button id="btn-google">Iniciar sesión con Google</button>
        <button id="btn-logout" style="display:none;">Cerrar sesión</button>

        <div id="usuario-info" style="display:none;">
          <img id="user-photo" src="" alt="Foto" width="48" />
          <div id="user-name"></div>
          <div id="user-email"></div>
        </div>
      </div>

      <footer>
        <p class="texto-footer">solo peludos</p>
      </footer>
    </aside>

    <main>
      <h2 class="titulo-principal" id="titulo-principal">Todos los productos</h2>
      <div id="contenedor-productos" class="contenedor-productos"></div>
    </main>
  </div>

  <!-- 🔹 Botón flotante de soporte -->
  <a 
    href="https://wa.me/573122406712?text=Hola,%20necesito%20ayuda%20con%20mi%20compra%20en%20PetMarket%20Online"
    class="btn-soporte"
    target="_blank"
    title="Soporte técnico"
  >
    <i class="bi bi-whatsapp"></i>
  </a>

  <!-- Scripts externos -->
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
  <script src="./js/main.js"></script>
  <script src="./js/menu.js"></script>

  <!-- 🔹 Script para el buscador -->
  <script>
    const inputBusqueda = document.getElementById('input-busqueda');
    const botonBuscar = document.getElementById('boton-buscar');

    document.addEventListener("DOMContentLoaded", () => {
      botonBuscar.addEventListener("click", filtrarProductos);
      inputBusqueda.addEventListener("keyup", (e) => {
        if (e.key === "Enter") filtrarProductos();
      });
    });

    function filtrarProductos() {
      const termino = inputBusqueda.value.toLowerCase().trim();
      const productos = document.querySelectorAll(".producto");

      productos.forEach(prod => {
        const nombre = prod.querySelector("h3").textContent.toLowerCase();
        const coincide = nombre.includes(termino);
        prod.style.display = coincide || termino === "" ? "block" : "none";
      });
    }
  </script>

  <!-- Firebase con imports modernos -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.3.0/firebase-app.js";
    import { getAuth, GoogleAuthProvider, signInWithPopup, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/12.3.0/firebase-auth.js";

    const firebaseConfig = {
      apiKey: "AIzaSyAuaWByo3uYzmU3jnhoZAZM1S79o3Uq1Xg",
      authDomain: "proyecto-petshop-6ea56.firebaseapp.com",
      projectId: "proyecto-petshop-6ea56",
      storageBucket: "proyecto-petshop-6ea56.appspot.com",
      messagingSenderId: "88005462823",
      appId: "1:88005462823:web:88b9509ed64c2bb01b3702",
      measurementId: "G-EXDPT7SSM8"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const provider = new GoogleAuthProvider();

    const btnGoogle = document.getElementById('btn-google');
    const btnLogout = document.getElementById('btn-logout');
    const userInfo = document.getElementById('usuario-info');
    const userName = document.getElementById('user-name');
    const userEmail = document.getElementById('user-email');
    const userPhoto = document.getElementById('user-photo');

    btnGoogle.addEventListener('click', async () => {
      try {
        const result = await signInWithPopup(auth, provider);
        console.log("Usuario logueado:", result.user);
      } catch (error) {
        console.error("Error login Google:", error);
        alert("Error al iniciar sesión: " + error.message);
      }
    });

    btnLogout.addEventListener('click', async () => {
      await signOut(auth);
    });

    onAuthStateChanged(auth, (user) => {
      if (user) {
        btnGoogle.style.display = 'none';
        btnLogout.style.display = 'inline-block';
        userInfo.style.display = 'block';
        userName.textContent = user.displayName;
        userEmail.textContent = user.email;
        userPhoto.src = user.photoURL;
      } else {
        btnGoogle.style.display = 'inline-block';
        btnLogout.style.display = 'none';
        userInfo.style.display = 'none';
        userName.textContent = '';
        userEmail.textContent = '';
        userPhoto.src = '';
      }
    });
  </script>
</body>
</html>



